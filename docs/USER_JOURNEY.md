# VTICS 用户旅程完整说明

## 📋 工具概述

**VTICS（Video Trend Intelligence Creation System）** 是一个从热点发现到拍摄脚本生成的全链路AI应用系统。

### 核心能力

✅ **已实现功能**：
1. **热点监控** - 自动监控抖音等平台热点，关键词筛选 
2. **视频拆解** - 自动拆解爆款视频，提取爆款技巧和公式
3. **脚本生成** - 基于热点+商品+爆款技巧，AI自动生成拍摄脚本和分镜
4. **数据管理** - 商品管理、直播间管理、脚本库管理
5. **前端界面** - Web管理后台，支持可视化操作

⚠️ **待实现功能**：
- 效果追踪模块（视频数据追踪、直播间数据追踪）

---

## 🎯 完整用户旅程

### 时间线说明
- **T-1日**：拍摄日，需要完成明日直播的引流视频拍摄
- **T日**：直播日，当日进行直播带货

---

## 📅 场景1：T-1日上午 8:00-10:00 - 热点发现与拆解

**用户角色**：编导团队

### 流程步骤

#### 1. 系统自动抓取热点（8:00）
- **操作**：系统通过Celery定时任务自动调用TrendRadar API
- **功能**：从抖音等平台抓取当日热点
- **API端点**：`POST /api/v1/hotspots/fetch`
- **前端操作**：也可手动点击"抓取热点"按钮

#### 2. 系统自动筛选相关热点
- **功能**：根据直播间主营类目和主推商品，自动进行语义关联度和情感关联度筛选
- **筛选方式**：
  - **语义关联度**：使用AI Embedding模型计算热点内容与直播间类目/商品的语义相似度
  - **情感关联度**：使用情感分析模型分析热点内容的情感倾向，与商品/直播间情感定位匹配
  - **自动筛选**：无需人工输入关键词，系统自动根据直播间配置进行筛选
- **匹配度计算**：
  - 匹配度 = 与直播间主推商品的匹配度
  - 计算方式：语义关联度（60%）+ 情感关联度（30%）+ 关键词匹配（10%）
  - 匹配度分数范围：0-1
- **前端展示**：
  - **气泡图可视化**（非列表或词云）
  - 横轴：热度（heat_score）
  - 纵轴：热度增长速率（heat_growth_rate）
  - 气泡大小：匹配度
  - 颜色区分：不同直播间类目
  - 支持交互：点击气泡查看详情

#### 3. 获取热点视频信息
- **功能**：提取热点视频的URL、标题、标签、热度等
- **数据存储**：保存到数据库的`hotspots`表

#### 4. 自动/手动拆解视频
- **操作方式1（自动）**：系统自动对筛选出的热点视频进行拆解
- **操作方式2（手动）**：编导在前端选择热点，点击"一键拆解"
- **API端点**：`POST /api/v1/analysis/analyze`
- **功能**：调用AI拆解工具分析视频结构

#### 5. 生成拆解报告
- **报告内容**：
  - 视频基础信息（标题、时长、主题）
  - 镜头拆解表格（每个镜头的时间、台词、画面、作用）
  - 黄金3秒分析（开头钩子、心理触发机制）
  - 爆款技巧提取（镜头语言、剪辑节奏、文案结构）
  - 爆款公式解析（反转公式、痛点公式等）
  - 制作要点（拍摄技巧、剪辑技巧、文案技巧）
- **数据存储**：保存到`analysis_reports`表

#### 6. 推送到飞书（9:00）
- **功能**：系统自动将筛选后的热点推送到飞书群
- **推送内容**：
  - 按直播间分组推送
  - 每个热点包含：标题、URL、热度、标签、匹配度
  - **匹配度说明**：匹配度是指热点与直播间主推商品的匹配度（基于语义关联度和情感关联度计算）
  - 支持"一键拆解"按钮（如果飞书支持）

#### 7. 编导查看和选择热点
- **前端页面**：热点监控页面（`/hotspots`）
- **功能**：
  - **气泡图可视化**：以气泡图形式展示热点，横轴为热度，纵轴为热度增长速率
  - 支持筛选：平台、直播间、时间
  - 查看热点详情（标题、URL、标签、热度、热度增长速率、匹配度）
  - 查看拆解报告（如果已拆解）
  - 选择适合的热点用于脚本生成
  - **匹配度说明**：显示的是与直播间主推商品的匹配度

---

## 📅 场景2：T-1日上午 10:00-11:00 - 脚本生成

**用户角色**：编导团队

### 流程步骤

#### 1. 选择热点和商品
- **前端页面**：脚本生成页面（`/scripts`）
- **操作**：点击"生成脚本"按钮
- **选择项**：
  - 选择热点（从热点列表中选择）
  - 选择商品（从商品列表中选择）
  - 选择拆解报告（可选，如果热点已拆解）
  - 设置视频时长（5-15秒）

#### 2. 系统整合信息
- **后台处理**：系统自动整合以下信息
  - 热点信息（标题、标签、URL）
  - 商品信息（名称、品牌、品类、卖点、价格、说明手卡）
  - 拆解报告（爆款技巧、爆款公式）
  - 直播间类型（女装/童装/家具等）

#### 3. AI生成脚本初稿
- **API端点**：`POST /api/v1/scripts/generate`
- **处理方式**：异步Celery任务
- **AI模型**：DeepSeek API
- **生成内容**：
  - 视频基本信息（标题、时长、主题、核心卖点）
  - 完整脚本内容（台词、动作、镜头描述）
  - 详细分镜表格（镜头编号、时间区间、景别、画面内容、台词、动作、音乐、作用、塑造点）
  - 制作要点（拍摄要点、剪辑要点、关键要点）
  - 推荐标签和话题

#### 4. 系统优化建议
- **功能**：系统自动检查脚本质量
- **检查项**：
  - 时长检查（是否在5-15秒范围内）
  - 分镜检查（分镜数量是否合理）
  - 标签检查（是否缺少推荐标签）
- **API端点**：`POST /api/v1/scripts/{id}/optimize`
- **前端展示**：优化建议对话框，显示建议列表

#### 5. 编导审核脚本
- **前端操作**：
  - 查看脚本详情（基本信息、脚本内容、分镜表格、制作要点）
  - 查看优化建议
  - 在线编辑脚本（如果需要修改）
  - 审核操作：通过/拒绝
- **API端点**：`POST /api/v1/scripts/{id}/review`
- **状态管理**：
  - `draft`：草稿
  - `approved`：已审核通过
  - `rejected`：已拒绝

#### 6. 生成最终脚本和分镜
- **输出格式**：
  - JSON格式的完整脚本数据
  - 分镜表格（可在前端以表格形式展示）
  - 制作要点文档
- **数据存储**：保存到`scripts`表

---

## 📅 场景3：T-1日下午 - 拍摄执行

**用户角色**：拍摄团队

### 流程步骤

#### 1. 查看脚本和分镜
- **前端页面**：脚本生成页面（`/scripts`）
- **操作**：点击脚本的"详情"按钮
- **查看内容**：
  - 脚本内容（完整台词和动作描述）
  - 分镜表格（每个镜头的详细要求）
  - 拍摄要点（系统生成的拍摄技巧）

#### 2. 理解拍摄要求
- **分镜表格包含**：
  - 镜头编号
  - 时间区间（如：0-3秒）
  - 景别（中景/特写/全景）
  - 画面内容描述
  - 台词
  - 动作要求
  - 音乐要求
  - 镜头作用
  - 塑造点

#### 3. 执行拍摄
- **操作**：拍摄团队按照脚本和分镜要求进行拍摄
- **输出**：拍摄完成的视频素材

---

## 📅 场景4：T-1日晚上 - 视频发布

**用户角色**：编导团队、剪辑团队

### 流程步骤

#### 1. 查看剪辑要点
- **前端页面**：脚本详情页面
- **查看内容**：
  - 剪辑要点（系统生成的剪辑技巧）
  - 关键要点（需要特别注意的点）

#### 2. 完成视频剪辑
- **操作**：剪辑团队按照脚本和剪辑要点完成视频剪辑
- **输出**：剪辑完成的视频

#### 3. 获取推荐标签和话题
- **前端页面**：脚本详情页面
- **查看内容**：
  - 推荐标签列表
  - 推荐话题列表
- **用途**：发布视频时使用，提高曝光

#### 4. 发布视频
- **操作**：编导审核视频质量后，发布到抖音等平台
- **使用标签**：使用系统推荐的标签和话题
- **目的**：为T日直播预热

---

## 📅 场景5：T日直播 - 效果追踪（待实现）

**用户角色**：电商负责人、编导团队

### 计划流程

#### 1. 追踪视频数据
- **数据指标**：
  - 播放量
  - 点赞数
  - 评论数
  - 分享数
  - 完播率
  - 转发率

#### 2. 追踪直播间数据
- **数据指标**：
  - 从视频进入直播间的人数
  - 直播间观看人数
  - 直播间转化率
  - 销售额

#### 3. 生成效果分析报告
- **分析内容**：
  - 视频表现分析
  - 热点应用效果分析
  - 脚本质量分析
  - 优化建议

---

## 🎨 前端界面说明

### 主要页面

1. **热点监控页面** (`/hotspots`)
   - **气泡图可视化**：以气泡图形式展示热点分布
     - 横轴：热度（heat_score）
     - 纵轴：热度增长速率（heat_growth_rate）
     - 气泡大小：匹配度
     - 颜色：区分直播间类目
   - 筛选热点（平台、直播间、时间）
   - 查看热点详情（包含与主推商品的匹配度）
   - 手动抓取热点

2. **视频拆解页面** (`/analysis`)
   - 查看拆解报告列表
   - 查看拆解报告详情
   - 手动触发视频拆解
   - 批量拆解视频

3. **脚本生成页面** (`/scripts`)
   - 查看脚本列表
   - 生成新脚本
   - 查看脚本详情（包含分镜表格）
   - 审核脚本
   - 获取优化建议

4. **商品管理页面** (`/products`)
   - 查看商品列表
   - 创建/编辑商品
   - 查看商品详情

5. **直播间管理页面** (`/live-rooms`)
   - 查看直播间列表
   - 管理直播间配置
   - 管理关键词

---

## 🔄 完整流程图

```
T-1日 8:00
  ↓
[系统自动抓取热点] → TrendRadar API
  ↓
[关键词筛选热点] → 匹配度计算
  ↓
[获取视频信息] → 保存到数据库
  ↓
[自动/手动拆解视频] → AI拆解工具
  ↓
[生成拆解报告] → 提取爆款技巧
  ↓
T-1日 9:00
  ↓
[推送到飞书] → 飞书群通知
  ↓
[编导查看和选择热点] → 前端界面
  ↓
T-1日 10:00
  ↓
[选择热点和商品] → 前端操作
  ↓
[系统整合信息] → 后台处理
  ↓
[AI生成脚本] → DeepSeek API
  ↓
[系统优化建议] → 自动检查
  ↓
[编导审核脚本] → 前端操作
  ↓
[生成最终脚本和分镜] → 保存到数据库
  ↓
T-1日下午
  ↓
[拍摄团队查看脚本] → 前端界面
  ↓
[执行拍摄] → 人工操作
  ↓
T-1日晚上
  ↓
[剪辑团队查看要点] → 前端界面
  ↓
[完成视频剪辑] → 人工操作
  ↓
[发布视频] → 使用推荐标签
  ↓
T日
  ↓
[效果追踪] → 待实现
```

---

## 📊 数据流转

```
TrendRadar系统
  ↓ (热点数据)
热点监控模块 → 保存到 hotspots 表
  ↓ (视频URL)
视频拆解模块 → 保存到 analysis_reports 表
  ↓ (拆解报告)
脚本生成模块 → 保存到 scripts 表
  ↓ (脚本数据)
前端界面 → 展示给用户
  ↓ (用户操作)
拍摄/剪辑团队 → 执行拍摄和剪辑
```

---

## 🎯 核心功能总结

### ✅ 已实现的核心功能

1. **热点监控**
   - ✅ 从TrendRadar获取热点
   - ⚠️ 关键词筛选（必须词+、普通词、过滤词!）- **需要升级为语义关联度筛选**
   - ⚠️ 匹配度计算和排序 - **需要改为与主推商品的匹配度**
   - ✅ 保存到数据库
   - ✅ 推送到飞书
   - ❌ **待实现**：语义关联度计算（使用Embedding模型）
   - ❌ **待实现**：情感关联度分析
   - ❌ **待实现**：热度增长速率计算/获取
   - ❌ **待实现**：前端气泡图可视化

2. **视频拆解**
   - ✅ 调用AI拆解工具
   - ✅ 解析拆解报告
   - ✅ 提取爆款技巧
   - ✅ 保存报告到数据库

3. **脚本生成**
   - ✅ 整合热点+商品+爆款技巧
   - ✅ 构建提示词
   - ✅ 调用DeepSeek生成脚本
   - ✅ 解析和格式化
   - ✅ 生成分镜表格
   - ✅ 提供优化建议

4. **数据管理**
   - ✅ 商品CRUD
   - ✅ 直播间CRUD
   - ✅ 脚本库管理
   - ✅ 拆解报告库管理

5. **前端界面**
   - ✅ 热点监控页面
   - ✅ 视频拆解页面
   - ✅ 脚本生成页面
   - ✅ 商品管理页面
   - ✅ 直播间管理页面

### ⚠️ 待实现功能

1. **热点监控增强**
   - ❌ 语义关联度计算（使用AI Embedding模型）
   - ❌ 情感关联度分析
   - ❌ 与主推商品的匹配度计算
   - ❌ 热度增长速率获取/计算
   - ❌ 前端气泡图可视化

2. **效果追踪模块**
   - ❌ 视频数据追踪
   - ❌ 直播间数据追踪
   - ❌ 效果分析报告

---

## 🚀 如何使用

### 1. 启动系统

```bash
# 启动后端API
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# 启动Celery Worker
celery -A app.celery_app worker --loglevel=info

# 启动Celery Beat（定时任务）
celery -A app.celery_app beat --loglevel=info

# 启动前端
cd frontend
npm run dev
```

### 2. 访问系统

- **前端界面**：http://localhost:5173
- **API文档**：http://localhost:8000/docs

### 3. 典型使用流程

1. **创建商品**：在商品管理页面创建商品信息
2. **抓取热点**：在热点监控页面点击"抓取热点"
3. **拆解视频**：选择热点，点击"一键拆解"
4. **生成脚本**：在脚本生成页面，选择热点和商品，生成脚本
5. **审核脚本**：查看脚本详情，审核通过
6. **查看分镜**：拍摄团队查看分镜表格，执行拍摄

---

## 📝 注意事项

1. **配置环境变量**：需要配置TrendRadar API、视频拆解工具API、DeepSeek API Key、飞书Webhook
2. **数据库初始化**：需要运行数据库迁移，创建初始数据
3. **异步任务**：脚本生成和视频拆解是异步任务，需要等待任务完成
4. **效果追踪**：效果追踪模块尚未实现，需要后续开发
5. **热点筛选升级**：
   - 当前使用关键词匹配，需要升级为语义关联度和情感关联度筛选
   - 需要集成Embedding API和情感分析API
   - 匹配度需要改为与主推商品的匹配度
6. **前端可视化**：需要实现气泡图替代列表展示
7. **TrendRadar集成**：需要确认TrendRadar API是否提供热度增长速率数据

---

## 📋 开发缺口说明

详细的开发缺口和待实现功能请参考：[开发缺口分析报告](./DEVELOPMENT_GAPS.md)

---

**最后更新**：2024年12月

