# äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰- ç¬¬ä¸‰éƒ¨åˆ†
## æŠ€æœ¯æ¶æ„ä¸é›†æˆæ–¹æ¡ˆ

---

## 9. æŠ€æœ¯æ¶æ„è®¾è®¡

### 9.1 ç³»ç»Ÿæ¶æ„

#### 9.1.1 æ•´ä½“æ¶æ„
é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯å±‚                               â”‚
â”‚  (Webç®¡ç†åå° + é£ä¹¦é›†æˆ)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APIç½‘å…³å±‚                              â”‚
â”‚  (ç»Ÿä¸€å…¥å£ã€é‰´æƒã€é™æµ)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çƒ­ç‚¹ç›‘æ§æœåŠ¡ â”‚  è§†é¢‘æ‹†è§£æœåŠ¡ â”‚  è„šæœ¬ç”ŸæˆæœåŠ¡ â”‚  æ•°æ®ç®¡ç†æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å­˜å‚¨å±‚                              â”‚
â”‚  (MySQL + Redis + æ–‡ä»¶å­˜å‚¨)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤–éƒ¨ç³»ç»Ÿ                                â”‚
â”‚  (TrendRadar + AIæ‹†è§£å·¥å…· + é£ä¹¦)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 9.1.2 æŠ€æœ¯æ ˆé€‰å‹

**åç«¯æŠ€æœ¯æ ˆ**ï¼š
- **è¯­è¨€**ï¼šPython 3.10+
- **æ¡†æ¶**ï¼šFastAPIï¼ˆAPIæœåŠ¡ï¼‰
- **ä»»åŠ¡é˜Ÿåˆ—**ï¼šCelery + Redisï¼ˆå¼‚æ­¥ä»»åŠ¡å¤„ç†ï¼‰
- **æ•°æ®åº“**ï¼šMySQL 8.0ï¼ˆä¸»æ•°æ®åº“ï¼‰
- **ç¼“å­˜**ï¼šRedis 7.0ï¼ˆç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼‰
- **æ–‡ä»¶å­˜å‚¨**ï¼šæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ–OSSï¼ˆè„šæœ¬ã€æŠ¥å‘Šå­˜å‚¨ï¼‰

**å‰ç«¯æŠ€æœ¯æ ˆ**ï¼š
- **æ¡†æ¶**ï¼šVue 3 + TypeScript
- **UIç»„ä»¶**ï¼šElement Plus
- **çŠ¶æ€ç®¡ç†**ï¼šPinia
- **HTTPå®¢æˆ·ç«¯**ï¼šAxios

**AI/MLæŠ€æœ¯æ ˆ**ï¼š
- **è„šæœ¬ç”Ÿæˆ**ï¼šOpenAI GPT-4 / Claude 3.5
- **æ–‡æœ¬å¤„ç†**ï¼šLangChainï¼ˆæç¤ºè¯ç®¡ç†ï¼‰
- **å‘é‡æ•°æ®åº“**ï¼šå¯é€‰ï¼ˆç”¨äºç›¸ä¼¼è„šæœ¬æ£€ç´¢ï¼‰

**éƒ¨ç½²æŠ€æœ¯æ ˆ**ï¼š
- **å®¹å™¨åŒ–**ï¼šDocker + Docker Compose
- **ç¼–æ’**ï¼šKubernetesï¼ˆå¯é€‰ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
- **ç›‘æ§**ï¼šPrometheus + Grafana
- **æ—¥å¿—**ï¼šELK Stackï¼ˆå¯é€‰ï¼‰

---

### 9.2 æ¨¡å—è¯¦ç»†è®¾è®¡

#### 9.2.1 çƒ­ç‚¹ç›‘æ§æœåŠ¡

**èŒè´£**ï¼š
- ä¸TrendRadarç³»ç»Ÿé›†æˆ
- å®šæ—¶æŠ“å–çƒ­ç‚¹æ•°æ®
- å…³é”®è¯ç­›é€‰
- è·å–è§†é¢‘URLå’Œè¯¦ç»†ä¿¡æ¯

**æŠ€æœ¯å®ç°**ï¼š
```python
# ä¼ªä»£ç ç¤ºä¾‹
class HotspotMonitorService:
    def __init__(self):
        self.trendradar_client = TrendRadarClient()
        self.keyword_filter = KeywordFilter()
        self.video_info_extractor = VideoInfoExtractor()
    
    async def fetch_hotspots(self, platform="douyin"):
        """æŠ“å–çƒ­ç‚¹"""
        hotspots = await self.trendradar_client.get_hotspots(platform)
        return hotspots
    
    async def filter_hotspots(self, hotspots, keywords):
        """å…³é”®è¯ç­›é€‰"""
        filtered = self.keyword_filter.filter(hotspots, keywords)
        return filtered
    
    async def get_video_info(self, video_url):
        """è·å–è§†é¢‘ä¿¡æ¯"""
        info = await self.video_info_extractor.extract(video_url)
        return info
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
class Hotspot:
    id: str
    title: str
    url: str
    platform: str
    tags: List[str]
    heat_score: int
    publish_time: datetime
    video_info: VideoInfo
    match_score: float  # åŒ¹é…åº¦
```

**APIæ¥å£**ï¼š
- `GET /api/v1/hotspots` - è·å–çƒ­ç‚¹åˆ—è¡¨
- `POST /api/v1/hotspots/fetch` - æ‰‹åŠ¨è§¦å‘æŠ“å–
- `GET /api/v1/hotspots/{id}` - è·å–çƒ­ç‚¹è¯¦æƒ…
- `POST /api/v1/hotspots/filter` - å…³é”®è¯ç­›é€‰

---

#### 9.2.2 è§†é¢‘æ‹†è§£æœåŠ¡

**èŒè´£**ï¼š
- è°ƒç”¨AIæ‹†è§£å·¥å…·API
- è§£ææ‹†è§£æŠ¥å‘Š
- æå–çˆ†æ¬¾æŠ€å·§
- ç®¡ç†æ‹†è§£æŠ¥å‘Šåº“

**æŠ€æœ¯å®ç°**ï¼š
```python
# ä¼ªä»£ç ç¤ºä¾‹
class VideoAnalysisService:
    def __init__(self):
        self.analyzer_client = VideoAnalyzerClient()
        self.report_parser = ReportParser()
        self.technique_extractor = TechniqueExtractor()
    
    async def analyze_video(self, video_url):
        """è°ƒç”¨æ‹†è§£å·¥å…·åˆ†æè§†é¢‘"""
        result = await self.analyzer_client.analyze(video_url)
        return result
    
    def parse_report(self, raw_data):
        """è§£ææ‹†è§£æŠ¥å‘Š"""
        report = self.report_parser.parse(raw_data)
        return report
    
    def extract_techniques(self, report):
        """æå–çˆ†æ¬¾æŠ€å·§"""
        techniques = self.technique_extractor.extract(report)
        return techniques
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
class AnalysisReport:
    id: str
    video_url: str
    video_info: VideoInfo
    basic_info: BasicInfo
    shot_table: List[Shot]
    golden_3s: Golden3S
    highlights: List[Highlight]
    viral_formula: ViralFormula
    keywords: Keywords
    production_tips: ProductionTips
    created_at: datetime
```

**APIæ¥å£**ï¼š
- `POST /api/v1/analysis/analyze` - åˆ†æè§†é¢‘
- `GET /api/v1/analysis/reports` - è·å–æ‹†è§£æŠ¥å‘Šåˆ—è¡¨
- `GET /api/v1/analysis/reports/{id}` - è·å–æ‹†è§£æŠ¥å‘Šè¯¦æƒ…
- `POST /api/v1/analysis/batch` - æ‰¹é‡åˆ†æ

---

#### 9.2.3 è„šæœ¬ç”ŸæˆæœåŠ¡

**èŒè´£**ï¼š
- æ•´åˆçƒ­ç‚¹ã€å•†å“ã€çˆ†æ¬¾æŠ€å·§ä¿¡æ¯
- è°ƒç”¨AIç”Ÿæˆè„šæœ¬
- ç”Ÿæˆåˆ†é•œè¡¨æ ¼
- æä¾›ä¼˜åŒ–å»ºè®®

**æŠ€æœ¯å®ç°**ï¼š
```python
# ä¼ªä»£ç ç¤ºä¾‹
class ScriptGeneratorService:
    def __init__(self):
        self.llm_client = LLMClient()  # GPT-4æˆ–Claude
        self.template_manager = TemplateManager()
        self.optimizer = ScriptOptimizer()
    
    async def generate_script(self, hotspot, product, analysis_report):
        """ç”Ÿæˆè„šæœ¬"""
        # æ„å»ºæç¤ºè¯
        prompt = self.build_prompt(hotspot, product, analysis_report)
        
        # è°ƒç”¨LLMç”Ÿæˆè„šæœ¬
        script_data = await self.llm_client.generate(prompt)
        
        # è§£æå’Œæ ¼å¼åŒ–
        script = self.parse_script(script_data)
        
        # ç”Ÿæˆåˆ†é•œè¡¨æ ¼
        shot_list = self.generate_shot_list(script)
        
        return {
            "script": script,
            "shot_list": shot_list,
            "production_notes": self.generate_notes(script),
            "tags": self.generate_tags(script)
        }
    
    def build_prompt(self, hotspot, product, analysis_report):
        """æ„å»ºæç¤ºè¯"""
        template = self.template_manager.get_template(product.category)
        prompt = template.format(
            hotspot=hotspot,
            product=product,
            techniques=analysis_report.techniques,
            viral_formula=analysis_report.viral_formula
        )
        return prompt
```

**æç¤ºè¯æ¨¡æ¿ç¤ºä¾‹**ï¼š
```
ä½ æ˜¯ä¸€ä½èµ„æ·±çŸ­è§†é¢‘ç¼–å¯¼ï¼Œéœ€è¦åŸºäºä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆä¸€ä¸ª5-15ç§’çš„å¼•æµçŸ­è§†é¢‘è„šæœ¬ï¼š

ã€çƒ­ç‚¹ä¿¡æ¯ã€‘
- çƒ­ç‚¹æ ‡é¢˜ï¼š{hotspot.title}
- çƒ­ç‚¹æ ‡ç­¾ï¼š{hotspot.tags}
- çˆ†æ¬¾æŠ€å·§ï¼š{techniques}
- çˆ†æ¬¾å…¬å¼ï¼š{viral_formula}

ã€å•†å“ä¿¡æ¯ã€‘
- å•†å“åç§°ï¼š{product.name}
- å“ç‰Œï¼š{product.brand}
- æ ¸å¿ƒå–ç‚¹ï¼š{product.selling_points}
- ä»·æ ¼ï¼š{product.price}

ã€è¦æ±‚ã€‘
1. è§†é¢‘æ—¶é•¿ï¼š5-15ç§’
2. ç»“åˆçƒ­ç‚¹è¯é¢˜å’Œå•†å“ç‰¹æ€§
3. è¿ç”¨çˆ†æ¬¾æŠ€å·§å’Œå…¬å¼
4. çªå‡ºå•†å“å–ç‚¹å’Œä»·æ ¼ä¼˜æƒ 
5. é€‚åˆ{product.category}ç›´æ’­é—´é£æ ¼

è¯·ç”Ÿæˆï¼š
1. å®Œæ•´è„šæœ¬ï¼ˆåŒ…å«å°è¯ã€åŠ¨ä½œã€é•œå¤´ï¼‰
2. è¯¦ç»†åˆ†é•œè¡¨æ ¼
3. æ‹æ‘„è¦ç‚¹
4. å‰ªè¾‘è¦ç‚¹
5. æ¨èæ ‡ç­¾å’Œè¯é¢˜
```

**æ•°æ®æ¨¡å‹**ï¼š
```python
class Script:
    id: str
    video_info: VideoInfo
    script_content: str
    shot_list: List[Shot]
    production_notes: ProductionNotes
    tags: Tags
    status: str  # draft/reviewed/approved
    created_at: datetime
    updated_at: datetime
```

**APIæ¥å£**ï¼š
- `POST /api/v1/scripts/generate` - ç”Ÿæˆè„šæœ¬
- `GET /api/v1/scripts` - è·å–è„šæœ¬åˆ—è¡¨
- `GET /api/v1/scripts/{id}` - è·å–è„šæœ¬è¯¦æƒ…
- `PUT /api/v1/scripts/{id}` - æ›´æ–°è„šæœ¬
- `POST /api/v1/scripts/{id}/review` - å®¡æ ¸è„šæœ¬
- `POST /api/v1/scripts/{id}/optimize` - è·å–ä¼˜åŒ–å»ºè®®

---

#### 9.2.4 æ•°æ®ç®¡ç†æœåŠ¡

**èŒè´£**ï¼š
- ç®¡ç†å•†å“ä¿¡æ¯
- ç®¡ç†ç›´æ’­é—´ä¿¡æ¯
- ç®¡ç†è„šæœ¬åº“
- ç®¡ç†æ‹†è§£æŠ¥å‘Šåº“

**æ•°æ®æ¨¡å‹**ï¼š
```python
class Product:
    id: str
    name: str
    brand: str
    category: str
    live_room_id: str
    product_link: str
    description: str
    selling_points: List[str]
    price: float
    hand_card: str
    live_date: date

class LiveRoom:
    id: str
    name: str
    category: str
    keywords: List[str]
    ip_character: str
    style: str
```

**APIæ¥å£**ï¼š
- `GET /api/v1/products` - è·å–å•†å“åˆ—è¡¨
- `POST /api/v1/products` - åˆ›å»ºå•†å“
- `PUT /api/v1/products/{id}` - æ›´æ–°å•†å“
- `GET /api/v1/live-rooms` - è·å–ç›´æ’­é—´åˆ—è¡¨
- `POST /api/v1/live-rooms` - åˆ›å»ºç›´æ’­é—´

---

### 9.3 æ•°æ®åº“è®¾è®¡

#### 9.3.1 æ ¸å¿ƒè¡¨ç»“æ„

**hotspotsè¡¨**ï¼ˆçƒ­ç‚¹è¡¨ï¼‰
```sql
CREATE TABLE hotspots (
    id VARCHAR(64) PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    url VARCHAR(500) NOT NULL,
    platform VARCHAR(50) NOT NULL,
    tags JSON,
    heat_score INT,
    publish_time DATETIME,
    video_info JSON,
    match_score FLOAT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_platform_time (platform, publish_time),
    INDEX idx_match_score (match_score)
);
```

**analysis_reportsè¡¨**ï¼ˆæ‹†è§£æŠ¥å‘Šè¡¨ï¼‰
```sql
CREATE TABLE analysis_reports (
    id VARCHAR(64) PRIMARY KEY,
    video_url VARCHAR(500) NOT NULL,
    video_info JSON,
    basic_info JSON,
    shot_table JSON,
    golden_3s JSON,
    highlights JSON,
    viral_formula JSON,
    keywords JSON,
    production_tips JSON,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_video_url (video_url)
);
```

**scriptsè¡¨**ï¼ˆè„šæœ¬è¡¨ï¼‰
```sql
CREATE TABLE scripts (
    id VARCHAR(64) PRIMARY KEY,
    hotspot_id VARCHAR(64),
    product_id VARCHAR(64),
    analysis_report_id VARCHAR(64),
    video_info JSON,
    script_content TEXT,
    shot_list JSON,
    production_notes JSON,
    tags JSON,
    status VARCHAR(20),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_product_id (product_id),
    INDEX idx_status (status)
);
```

**productsè¡¨**ï¼ˆå•†å“è¡¨ï¼‰
```sql
CREATE TABLE products (
    id VARCHAR(64) PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    brand VARCHAR(100),
    category VARCHAR(50),
    live_room_id VARCHAR(64),
    product_link VARCHAR(500),
    description TEXT,
    selling_points JSON,
    price DECIMAL(10, 2),
    hand_card TEXT,
    live_date DATE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_live_room_id (live_room_id),
    INDEX idx_live_date (live_date)
);
```

**live_roomsè¡¨**ï¼ˆç›´æ’­é—´è¡¨ï¼‰
```sql
CREATE TABLE live_rooms (
    id VARCHAR(64) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    category VARCHAR(50) NOT NULL,
    keywords JSON,
    ip_character VARCHAR(100),
    style VARCHAR(100),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

---

### 9.4 å¤–éƒ¨ç³»ç»Ÿé›†æˆ

#### 9.4.1 TrendRadaré›†æˆ

**é›†æˆæ–¹å¼**ï¼š
- **æ–¹æ¡ˆA**ï¼šAPIé›†æˆï¼ˆå¦‚æœTrendRadaræä¾›APIï¼‰
- **æ–¹æ¡ˆB**ï¼šæ•°æ®åº“é›†æˆï¼ˆå¦‚æœTrendRadaræ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ï¼‰
- **æ–¹æ¡ˆC**ï¼šæ–‡ä»¶é›†æˆï¼ˆå¦‚æœTrendRadarè¾“å‡ºæ–‡ä»¶ï¼‰

**æ•°æ®æ ¼å¼**ï¼š
```json
{
  "hotspots": [
    {
      "title": "çƒ­ç‚¹æ ‡é¢˜",
      "url": "https://www.douyin.com/video/xxx",
      "platform": "douyin",
      "tags": ["#æ ‡ç­¾1", "#æ ‡ç­¾2"],
      "heat_score": 95,
      "publish_time": "2024-11-12 08:00:00"
    }
  ]
}
```

**é›†æˆæ¥å£**ï¼š
```python
class TrendRadarClient:
    async def get_hotspots(self, platform="douyin", date=None):
        """è·å–çƒ­ç‚¹åˆ—è¡¨"""
        # å®ç°é€»è¾‘
        pass
    
    async def get_hotspot_detail(self, hotspot_id):
        """è·å–çƒ­ç‚¹è¯¦æƒ…"""
        # å®ç°é€»è¾‘
        pass
```

---

#### 9.4.2 AIæ‹†è§£å·¥å…·é›†æˆ

**é›†æˆæ–¹å¼**ï¼š
- **æ–¹æ¡ˆA**ï¼šAPIé›†æˆï¼ˆæ¨èï¼‰
- **æ–¹æ¡ˆB**ï¼šå‘½ä»¤è¡Œè°ƒç”¨
- **æ–¹æ¡ˆC**ï¼šSDKé›†æˆ

**APIæ¥å£è®¾è®¡**ï¼ˆå¦‚æœæ‹†è§£å·¥å…·æä¾›APIï¼‰ï¼š
```python
POST /api/v1/analyze
Request:
{
    "video_url": "https://www.douyin.com/video/xxx",
    "options": {
        "include_shot_table": true,
        "include_golden_3s": true,
        "include_viral_formula": true
    }
}

Response:
{
    "status": "success",
    "report_id": "report_xxx",
    "data": {
        // æ‹†è§£æŠ¥å‘Šæ•°æ®
    }
}
```

**é›†æˆæ¥å£**ï¼š
```python
class VideoAnalyzerClient:
    def __init__(self, api_url, api_key):
        self.api_url = api_url
        self.api_key = api_key
    
    async def analyze(self, video_url, options=None):
        """è°ƒç”¨æ‹†è§£å·¥å…·åˆ†æè§†é¢‘"""
        response = await self.http_client.post(
            f"{self.api_url}/api/v1/analyze",
            json={
                "video_url": video_url,
                "options": options or {}
            },
            headers={"Authorization": f"Bearer {self.api_key}"}
        )
        return response.json()
```

---

#### 9.4.3 é£ä¹¦é›†æˆ

**é›†æˆæ–¹å¼**ï¼š
- ä½¿ç”¨é£ä¹¦å¼€æ”¾å¹³å°API
- Webhookæ¨é€æ¶ˆæ¯

**æ¶ˆæ¯å¡ç‰‡æ ¼å¼**ï¼š
```json
{
    "msg_type": "interactive",
    "card": {
        "config": {
            "wide_screen_mode": true
        },
        "header": {
            "title": {
                "content": "ã€å¥³è£…ç›´æ’­é—´ã€‘ä»Šæ—¥çƒ­ç‚¹æ¨è",
                "tag": "plain_text"
            }
        },
        "elements": [
            {
                "tag": "div",
                "text": {
                    "content": "ğŸ”¥ çƒ­ç‚¹1ï¼šå˜è£…ç§€æŒ‘æˆ˜\nçƒ­åº¦ï¼šâ˜…â˜…â˜…â˜…â˜…\nè§†é¢‘é“¾æ¥ï¼šhttps://www.douyin.com/video/xxx",
                    "tag": "lark_md"
                }
            },
            {
                "tag": "action",
                "actions": [
                    {
                        "tag": "button",
                        "text": {
                            "content": "ä¸€é”®æ‹†è§£",
                            "tag": "plain_text"
                        },
                        "type": "primary",
                        "url": "https://your-system.com/analyze?video_url=xxx"
                    }
                ]
            }
        ]
    }
}
```

**é›†æˆæ¥å£**ï¼š
```python
class FeishuClient:
    def __init__(self, webhook_url):
        self.webhook_url = webhook_url
    
    async def send_message(self, card_data):
        """å‘é€é£ä¹¦æ¶ˆæ¯"""
        response = await self.http_client.post(
            self.webhook_url,
            json=card_data
        )
        return response.json()
```

---

### 9.5 ä»»åŠ¡è°ƒåº¦è®¾è®¡

#### 9.5.1 å®šæ—¶ä»»åŠ¡

ä½¿ç”¨Celery + Rediså®ç°å®šæ—¶ä»»åŠ¡ï¼š

**ä»»åŠ¡1ï¼šæ¯æ—¥çƒ­ç‚¹æŠ“å–**
```python
@celery_app.task
def fetch_daily_hotspots():
    """æ¯æ—¥8:00è‡ªåŠ¨æŠ“å–çƒ­ç‚¹"""
    monitor_service = HotspotMonitorService()
    hotspots = await monitor_service.fetch_hotspots()
    # å¤„ç†çƒ­ç‚¹æ•°æ®
    pass
```

**ä»»åŠ¡2ï¼šçƒ­ç‚¹æ¨é€**
```python
@celery_app.task
def push_hotspots_to_feishu():
    """æ¯æ—¥9:00æ¨é€çƒ­ç‚¹åˆ°é£ä¹¦"""
    # è·å–ç­›é€‰åçš„çƒ­ç‚¹
    # ç”Ÿæˆé£ä¹¦æ¶ˆæ¯å¡ç‰‡
    # æ¨é€åˆ°é£ä¹¦
    pass
```

**ä»»åŠ¡3ï¼šæ•°æ®æ¸…ç†**
```python
@celery_app.task
def cleanup_old_data():
    """æ¸…ç†7å¤©å‰çš„çƒ­ç‚¹æ•°æ®"""
    # åˆ é™¤è¿‡æœŸæ•°æ®
    pass
```

#### 9.5.2 å¼‚æ­¥ä»»åŠ¡

**ä»»åŠ¡1ï¼šè§†é¢‘æ‹†è§£**
```python
@celery_app.task
def analyze_video_async(video_url):
    """å¼‚æ­¥æ‹†è§£è§†é¢‘"""
    analysis_service = VideoAnalysisService()
    report = await analysis_service.analyze_video(video_url)
    # ä¿å­˜æŠ¥å‘Š
    pass
```

**ä»»åŠ¡2ï¼šè„šæœ¬ç”Ÿæˆ**
```python
@celery_app.task
def generate_script_async(hotspot_id, product_id, analysis_report_id):
    """å¼‚æ­¥ç”Ÿæˆè„šæœ¬"""
    script_service = ScriptGeneratorService()
    script = await script_service.generate_script(...)
    # ä¿å­˜è„šæœ¬
    pass
```

---

### 9.6 å®‰å…¨è®¾è®¡

#### 9.6.1 è®¤è¯æˆæƒ
- ä½¿ç”¨JWT Tokenè¿›è¡ŒAPIè®¤è¯
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- ä¸åŒè§’è‰²æœ‰ä¸åŒçš„æƒé™

#### 9.6.2 æ•°æ®å®‰å…¨
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨ï¼ˆå•†å“ä¿¡æ¯ã€è„šæœ¬æ•°æ®ï¼‰
- APIæ¥å£ä½¿ç”¨HTTPS
- æ•°æ®åº“è¿æ¥åŠ å¯†

#### 9.6.3 æ—¥å¿—å®¡è®¡
- è®°å½•æ‰€æœ‰å…³é”®æ“ä½œ
- è®°å½•APIè°ƒç”¨æ—¥å¿—
- è®°å½•é”™è¯¯æ—¥å¿—

---

*æœ¬æ–‡æ¡£ä¸ºPRDç¬¬ä¸‰éƒ¨åˆ†ï¼ŒåŒ…å«æŠ€æœ¯æ¶æ„å’Œé›†æˆæ–¹æ¡ˆã€‚*

