# 产品需求文档（PRD）- 第二部分
## 详细功能需求与业务流程

---

## 6. 详细功能需求

### 6.1 热点监控模块

#### 6.1.1 功能描述
自动监控抖音等平台的热点内容，筛选与商品相关的热点视频，获取视频URL和详细信息。

#### 6.1.2 功能清单

**F1.1 平台监控**
- **功能**：支持监控多个平台的热点内容
- **优先级**：P0（必须）
- **输入**：平台列表（抖音、微博、B站等）
- **输出**：各平台的热点内容列表
- **业务规则**：
  - 每日定时抓取（默认8:00）
  - 支持手动触发抓取
  - 支持自定义抓取频率（5-15分钟）

**F1.2 关键词筛选**
- **功能**：根据关键词筛选相关热点
- **优先级**：P0（必须）
- **输入**：
  - 关键词列表（支持普通词、必须词、过滤词）
  - 直播间类型（女装/童装/家具/奢侈品/美妆）
- **输出**：筛选后的热点列表
- **业务规则**：
  - 必须词（+标记）：必须包含，否则不匹配
  - 普通词：包含即可，提高匹配度
  - 过滤词（!标记）：包含则排除
  - 匹配度计算：必须词权重50%，普通词权重30%，过滤词权重-100%

**F1.3 视频信息获取**
- **功能**：获取热点视频的详细信息
- **优先级**：P0（必须）
- **输入**：热点视频标题/ID
- **输出**：
  - 视频URL（关键字段）
  - 视频标题
  - 视频标签
  - 视频热度数据（播放量、点赞、评论）
  - 视频时长
  - 发布时间
  - 作者信息
- **业务规则**：
  - URL必须可访问
  - 信息不完整时标记为"待补充"
  - 支持批量获取

**F1.4 热点推送**
- **功能**：将筛选后的热点推送到飞书
- **优先级**：P0（必须）
- **输入**：热点列表（含视频信息）
- **输出**：飞书消息卡片
- **业务规则**：
  - 按直播间分组推送
  - 每个热点包含：标题、URL、热度、标签
  - 支持"一键拆解"按钮（如果飞书支持）
  - 推送时间：每日9:00

**F1.5 热点管理**
- **功能**：管理历史热点数据
- **优先级**：P1（重要）
- **输入**：无
- **输出**：热点列表、搜索、筛选
- **业务规则**：
  - 保留最近7天的热点数据
  - 支持按时间、平台、关键词搜索
  - 支持收藏热点

---

### 6.2 视频拆解模块

#### 6.2.1 功能描述
接收热点视频URL，调用AI拆解工具进行深度分析，生成结构化拆解报告，提取爆款技巧和公式。

#### 6.2.2 功能清单

**F2.1 视频拆解调用**
- **功能**：调用AI拆解工具分析视频
- **优先级**：P0（必须）
- **输入**：
  - 视频URL
  - 拆解工具配置（API地址、密钥等）
- **输出**：拆解工具返回的原始数据
- **业务规则**：
  - 支持单个视频拆解
  - 支持批量视频拆解（最多10个）
  - 拆解超时时间：10分钟
  - 失败重试：最多3次

**F2.2 拆解报告解析**
- **功能**：解析拆解工具返回的数据，生成结构化报告
- **优先级**：P0（必须）
- **输入**：拆解工具原始数据
- **输出**：结构化拆解报告
- **数据结构**：
  ```json
  {
    "video_info": {
      "title": "视频标题",
      "duration": "视频时长",
      "url": "视频URL"
    },
    "basic_info": {
      "theme": "视频主题",
      "content_type": "内容类型",
      "core_value": "核心价值点",
      "target_audience": "目标受众"
    },
    "shot_table": [
      {
        "shot_number": "镜头编号",
        "time_range": "时间区间",
        "dialogue": "对应台词",
        "content": "画面内容描述",
        "purpose": "镜头作用",
        "shaping_point": "塑造点",
        "viral_technique": "爆款技巧运用"
      }
    ],
    "golden_3s": {
      "opening_line": "开头话术",
      "hook_type": "钩子类型",
      "design_intention": "设计意图",
      "psychology_trigger": "心理触发机制"
    },
    "highlights": [
      {
        "name": "亮点名称",
        "description": "详细描述",
        "viral_reason": "爆款原因"
      }
    ],
    "viral_formula": {
      "formula_name": "公式名称",
      "formula_structure": "公式结构",
      "application_method": "运用方式",
      "effectiveness": "有效性分析"
    },
    "keywords": {
      "content_keywords": ["内容关键词"],
      "emotional_keywords": ["情绪关键词"],
      "behavioral_keywords": ["行为关键词"],
      "trending_keywords": ["热点关键词"]
    },
    "production_tips": {
      "shooting_tips": ["拍摄技巧"],
      "editing_tips": ["剪辑技巧"],
      "copywriting_tips": ["文案技巧"]
    }
  }
  ```

**F2.3 爆款技巧提取**
- **功能**：从拆解报告中提取可复制的爆款技巧
- **优先级**：P0（必须）
- **输入**：拆解报告
- **输出**：爆款技巧列表
- **提取内容**：
  - 镜头语言技巧（快速切换、慢镜头等）
  - 剪辑节奏技巧（快节奏、慢节奏等）
  - 文案结构技巧（反转公式、痛点公式等）
  - 黄金3秒技巧（悬念钩子、利益钩子等）
  - 标签和话题技巧

**F2.4 拆解报告管理**
- **功能**：管理拆解报告库
- **优先级**：P1（重要）
- **输入**：无
- **输出**：拆解报告列表、搜索、查看
- **业务规则**：
  - 永久保存所有拆解报告
  - 支持按视频、时间、技巧类型搜索
  - 支持报告对比分析
  - 支持导出报告（PDF、Word）

**F2.5 批量拆解**
- **功能**：批量拆解多个热点视频
- **优先级**：P1（重要）
- **输入**：视频URL列表（最多10个）
- **输出**：批量拆解报告
- **业务规则**：
  - 支持队列处理
  - 显示处理进度
  - 支持部分失败（继续处理其他视频）

---

### 6.3 脚本生成模块

#### 6.3.1 功能描述
基于热点信息、商品信息、爆款技巧，自动生成拍摄脚本和分镜表格。

#### 6.3.2 功能清单

**F3.1 脚本生成**
- **功能**：基于输入信息生成拍摄脚本
- **优先级**：P0（必须）
- **输入**：
  - 选择的热点视频（含拆解报告）
  - 商品信息（名称、品牌、链接、说明手卡）
  - 直播间类型
  - 视频时长要求（5-15秒）
- **输出**：完整拍摄脚本
- **脚本结构**：
  ```json
  {
    "video_info": {
      "title": "视频标题",
      "duration": "视频时长",
      "theme": "视频主题",
      "core_selling_point": "核心卖点"
    },
    "script_content": "完整脚本内容",
    "shot_list": [
      {
        "shot_number": "镜头编号",
        "time_range": "时间区间",
        "shot_type": "镜头类型（中景/特写/全景）",
        "content": "画面内容描述",
        "dialogue": "台词",
        "action": "动作",
        "music": "音乐",
        "purpose": "镜头作用",
        "shaping_point": "塑造点"
      }
    ],
    "production_notes": {
      "shooting_tips": ["拍摄要点"],
      "editing_tips": ["剪辑要点"],
      "key_points": ["关键要点"]
    },
    "tags": {
      "recommended_tags": ["推荐标签"],
      "recommended_topics": ["推荐话题"]
    }
  }
  ```

**F3.2 分镜表格生成**
- **功能**：生成详细的分镜表格
- **优先级**：P0（必须）
- **输入**：脚本数据
- **输出**：分镜表格（Markdown/Excel格式）
- **表格结构**：
  | 镜头编号 | 时间区间 | 镜头类型 | 画面内容 | 台词 | 动作 | 音乐 | 镜头作用 | 塑造点 |
  |---------|---------|---------|---------|------|------|------|---------|--------|
  | 1 | 0-3秒 | 中景 | ... | ... | ... | ... | ... | ... |

**F3.3 脚本优化建议**
- **功能**：提供脚本优化建议
- **优先级**：P1（重要）
- **输入**：生成的脚本
- **输出**：优化建议列表
- **建议类型**：
  - 时长优化（是否过长或过短）
  - 节奏优化（是否过快或过慢）
  - 内容优化（是否突出卖点）
  - 标签优化（是否匹配内容）

**F3.4 脚本模板管理**
- **功能**：管理脚本模板库
- **优先级**：P1（重要）
- **输入**：无
- **输出**：模板列表、创建、编辑、删除
- **业务规则**：
  - 支持按直播间类型创建模板
  - 支持模板复用
  - 支持模板版本管理

**F3.5 脚本审核**
- **功能**：编导审核和优化脚本
- **优先级**：P0（必须）
- **输入**：生成的脚本
- **输出**：审核后的脚本
- **业务规则**：
  - 支持在线编辑脚本
  - 支持版本对比
  - 支持审核意见记录
  - 支持一键通过/驳回

---

### 6.4 数据管理模块

#### 6.4.1 功能描述
管理系统中的各类数据，包括商品信息、直播间信息、脚本库、拆解报告库等。

#### 6.4.2 功能清单

**F4.1 商品信息管理**
- **功能**：管理商品信息
- **优先级**：P0（必须）
- **输入**：商品信息
- **输出**：商品列表、详情
- **数据结构**：
  ```json
  {
    "product_id": "商品ID",
    "product_name": "商品名称",
    "brand": "品牌",
    "category": "品类",
    "live_room": "所属直播间",
    "product_link": "商品链接",
    "description": "商品描述",
    "selling_points": ["卖点列表"],
    "price": "价格",
    "hand_card": "说明手卡内容",
    "live_date": "直播日期"
  }
  ```
- **功能点**：
  - 商品信息录入
  - 商品信息编辑
  - 商品信息查询
  - 商品信息删除
  - 商品信息导入/导出

**F4.2 直播间信息管理**
- **功能**：管理直播间信息
- **优先级**：P0（必须）
- **输入**：直播间信息
- **输出**：直播间列表、详情
- **数据结构**：
  ```json
  {
    "room_id": "直播间ID",
    "room_name": "直播间名称",
    "category": "直播间类型（女装/童装/家具/奢侈品/美妆）",
    "keywords": ["关键词列表"],
    "ip_character": "IP形象（罗永浩等）",
    "style": "风格定位"
  }
  ```

**F4.3 脚本库管理**
- **功能**：管理历史脚本
- **优先级**：P1（重要）
- **输入**：无
- **输出**：脚本列表、详情
- **功能点**：
  - 脚本搜索（按商品、时间、直播间）
  - 脚本查看
  - 脚本对比
  - 脚本复用
  - 脚本导出

**F4.4 拆解报告库管理**
- **功能**：管理拆解报告
- **优先级**：P1（重要）
- **输入**：无
- **输出**：报告列表、详情
- **功能点**：
  - 报告搜索（按视频、时间、技巧）
  - 报告查看
  - 报告对比
  - 报告导出

---

### 6.5 效果追踪模块

#### 6.5.1 功能描述
追踪视频发布后的数据，分析效果，提供优化建议。

#### 6.5.2 功能清单

**F5.1 视频数据追踪**
- **功能**：追踪视频发布后的数据
- **优先级**：P1（重要）
- **输入**：视频URL
- **输出**：视频数据
- **数据指标**：
  - 播放量
  - 点赞数
  - 评论数
  - 分享数
  - 完播率
  - 转发率

**F5.2 直播间数据追踪**
- **功能**：追踪从视频进入直播间的人数
- **优先级**：P1（重要）
- **输入**：视频URL、直播间ID
- **输出**：直播间数据
- **数据指标**：
  - 从视频进入直播间的人数
  - 直播间观看人数
  - 直播间转化率
  - 销售额

**F5.3 效果分析报告**
- **功能**：生成效果分析报告
- **优先级**：P1（重要）
- **输入**：视频数据、直播间数据
- **输出**：分析报告
- **分析内容**：
  - 视频表现分析
  - 热点应用效果分析
  - 脚本质量分析
  - 优化建议

**F5.4 数据对比分析**
- **功能**：对比不同视频的效果
- **优先级**：P2（一般）
- **输入**：多个视频ID
- **输出**：对比分析报告
- **对比维度**：
  - 播放量对比
  - 转化率对比
  - 热点应用效果对比

---

## 7. 完整业务流程

### 7.1 主流程：从热点到脚本生成

```
开始
  ↓
[Step 1] TrendRadar自动抓取热点（T-1日 8:00）
  ↓
[Step 2] 系统筛选与商品相关的热点
  ↓
[Step 3] 获取热点视频URL和详细信息
  ↓
[Step 4] 自动调用拆解工具分析热点视频
  ↓
[Step 5] 生成"热点+拆解"综合报告
  ↓
[Step 6] 推送到飞书（T-1日 9:00）
  ↓
[Step 7] 编导团队查看报告，选择适合的热点
  ↓
[Step 8] 编导输入商品详细信息
  ↓
[Step 9] 系统基于热点+商品+爆款技巧生成脚本
  ↓
[Step 10] 编导审核和优化脚本
  ↓
[Step 11] 生成最终拍摄脚本和分镜（T-1日 10:00前）
  ↓
[Step 12] 拍摄团队按脚本执行拍摄（T-1日下午）
  ↓
[Step 13] 剪辑团队完成视频剪辑（T-1日晚上）
  ↓
[Step 14] 发布视频到抖音等平台（T-1日晚上）
  ↓
[Step 15] 追踪视频和直播间数据（T日）
  ↓
[Step 16] 生成效果分析报告
  ↓
结束
```

### 7.2 子流程1：热点发现与拆解

```
开始
  ↓
[1.1] TrendRadar定时任务触发（每日8:00）
  ↓
[1.2] 调用TrendRadar API获取热点列表
  ↓
[1.3] 根据关键词筛选热点
  ├─ 必须词匹配
  ├─ 普通词匹配
  └─ 过滤词排除
  ↓
[1.4] 获取热点视频URL和详细信息
  ↓
[1.5] 判断是否需要拆解
  ├─ 是 → 调用拆解工具
  └─ 否 → 直接推送
  ↓
[1.6] 拆解工具分析视频
  ├─ 成功 → 生成拆解报告
  └─ 失败 → 记录错误，继续处理
  ↓
[1.7] 解析拆解报告，提取爆款技巧
  ↓
[1.8] 生成"热点+拆解"综合报告
  ↓
[1.9] 推送到飞书（按直播间分组）
  ↓
结束
```

### 7.3 子流程2：脚本生成

```
开始
  ↓
[2.1] 编导选择要应用的热点
  ↓
[2.2] 输入商品详细信息
  ├─ 商品名称
  ├─ 品牌
  ├─ 商品链接
  ├─ 说明手卡
  └─ 直播间类型
  ↓
[2.3] 系统整合信息
  ├─ 热点信息
  ├─ 商品信息
  ├─ 拆解报告（爆款技巧）
  └─ 脚本模板
  ↓
[2.4] AI生成脚本初稿
  ├─ 生成脚本内容
  ├─ 生成分镜表格
  ├─ 生成拍摄要点
  └─ 生成剪辑要点
  ↓
[2.5] 系统优化建议
  ├─ 时长检查
  ├─ 节奏检查
  ├─ 内容检查
  └─ 标签检查
  ↓
[2.6] 编导审核脚本
  ├─ 通过 → 生成最终脚本
  └─ 需要修改 → 在线编辑
  ↓
[2.7] 生成最终脚本和分镜
  ↓
[2.8] 推送给拍摄团队和剪辑团队
  ↓
结束
```

### 7.4 异常流程

**异常1：热点获取失败**
- 处理：记录错误，发送通知，使用缓存数据或手动输入

**异常2：拆解工具调用失败**
- 处理：重试3次，仍失败则标记为"待拆解"，推送热点基本信息

**异常3：脚本生成失败**
- 处理：记录错误，发送通知，编导手动创建脚本

**异常4：视频URL无效**
- 处理：标记为"URL无效"，跳过该热点

---

## 8. 数据流转设计

### 8.1 数据流图

```
TrendRadar系统
    ↓ (热点数据)
热点监控模块
    ↓ (视频URL)
视频拆解模块
    ↓ (拆解报告)
脚本生成模块
    ↓ (脚本数据)
数据管理模块
    ↓ (效果数据)
效果追踪模块
```

### 8.2 关键数据接口

**接口1：TrendRadar → 热点监控模块**
- 数据格式：JSON
- 字段：标题、URL、标签、热度、时间
- 频率：每日一次（可配置）

**接口2：热点监控模块 → 视频拆解模块**
- 数据格式：视频URL
- 调用方式：API调用
- 返回：拆解报告JSON

**接口3：拆解模块 → 脚本生成模块**
- 数据格式：拆解报告JSON
- 使用方式：数据查询
- 频率：按需

**接口4：脚本生成模块 → 飞书**
- 数据格式：飞书消息卡片
- 推送方式：Webhook
- 频率：按需

---

*本文档为PRD第二部分，包含详细功能需求和完整业务流程。*

